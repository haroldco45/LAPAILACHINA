<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LA PAILA CHINA - Pedidos</title>
    <style>
        :root {
            --rojo-china: #CC0000;
            --dorado: #FFD700;
            --negro: #1a1a1a;
            --blanco: #ffffff;
            --gris-oscuro: #2a2a2a;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--negro);
            color: var(--blanco);
            margin: 0;
            padding-bottom: 100px;
        }

        /* PANTALLA DE BLOQUEO (T√ö CONTROLAS ESTO DESDE GITHUB) */
        #pantalla-bloqueo {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            z-index: 99999;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 30px;
        }

        header {
            background-color: var(--rojo-china);
            text-align: center;
            padding: 20px;
            border-bottom: 4px solid var(--dorado);
        }

        .titulo-restaurante {
            font-size: 26px;
            font-weight: bold;
            color: var(--dorado);
            text-transform: uppercase;
            margin: 0;
        }

        .info-contacto {
            font-size: 0.85em;
            margin-top: 5px;
            color: var(--blanco);
        }

        .container { padding: 20px; }

        /* Formulario de Registro */
        #seccion-registro {
            background: var(--gris-oscuro);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid var(--dorado);
        }

        input, textarea {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #444;
            background: #111;
            color: white;
            box-sizing: border-box;
            font-size: 16px;
        }

        /* Cards de Men√∫ */
        .plato-card {
            background: var(--gris-oscuro);
            border-radius: 12px;
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 15px;
            border-left: 6px solid var(--rojo-china);
        }

        .plato-detalles { flex-grow: 1; }
        .plato-nombre { font-weight: bold; color: var(--dorado); font-size: 1.1em; }
        .plato-precio { color: #4CAF50; font-weight: bold; font-size: 1.1em; }

        .controles {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .btn-accion {
            background: var(--rojo-china);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-weight: bold;
            font-size: 20px;
            cursor: pointer;
        }

        .footer-fixed {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: #000;
            border-top: 3px solid var(--rojo-china);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-sizing: border-box;
        }

        .btn-finalizar {
            background: #25D366;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
        }

        .oculto { display: none !important; }
    </style>
</head>
<body>

<div id="pantalla-bloqueo">
    <h1 style="font-size: 60px;">üèÆ</h1>
    <h2 style="color: var(--dorado);">SERVICIO SUSPENDIDO</h2>
    <p>La licencia de esta aplicaci√≥n ha vencido o se encuentra en mantenimiento temporal.</p>
    <p>Por favor, contacte al desarrollador para reactivar el servicio.</p>
</div>

<div id="app-body">
    <header>
        <div class="titulo-restaurante">La Paila China</div>
        <div class="info-contacto">
            üìç Caucasia, Antioquia<br>
            üìû Pedidos: 311 770 0431
        </div>
    </header>

    <div class="container">
        <div id="seccion-registro" class="oculto">
            <h3 style="color: var(--dorado); text-align: center; margin-top: 0;">¬°Bienvenido!</h3>
            <p style="font-size: 0.9em; text-align: center;">Ingresa tus datos de env√≠o (se guardar√°n para futuros pedidos).</p>
            <input type="text" id="reg-nombre" placeholder="Nombre Completo">
            <input type="text" id="reg-direccion" placeholder="Direcci√≥n de Entrega">
            <input type="tel" id="reg-tel" placeholder="N√∫mero de Celular">
            <input type="email" id="reg-correo" placeholder="Correo Electr√≥nico">
            <button onclick="registrar()" class="btn-finalizar" style="width: 100%; margin-top: 10px; background: var(--rojo-china);">GUARDAR Y VER MEN√ö</button>
        </div>

        <div id="seccion-menu">
            <div class="plato-card">
                <div class="plato-detalles">
                    <div class="plato-nombre">Arroz Especial</div>
                    <div style="font-size: 0.8em; color: #ccc; margin-bottom: 5px;">Lomo, pollo, ra√≠ces chinas y salsa soja.</div>
                    <div class="plato-precio">$28.000</div>
                </div>
                <div class="controles">
                    <button class="btn-accion" onclick="cambiarCant('arroz', -1)">-</button>
                    <span id="cant-arroz" style="font-weight:bold; font-size:1.2em;">0</span>
                    <button class="btn-accion" onclick="cambiarCant('arroz', 1)">+</button>
                </div>
            </div>

            <h3 style="margin-top: 25px; border-bottom: 1px solid #444;">Instrucciones Especiales</h3>
            <textarea id="pedido-obs" rows="3" placeholder="Ej: Traer cambio de 50 mil, casa azul, sin cebolla..."></textarea>
        </div>
    </div>

    <div class="footer-fixed">
        <div style="font-size: 1.2em; font-weight: bold;">Total: <span id="total-display" style="color: var(--dorado);">$0</span></div>
        <button class="btn-finalizar" onclick="enviarWhatsApp()">Pedir por WhatsApp</button>
    </div>
</div>

<script>
    /* ==========================================
       LLAVE MAESTRA DE COBRO (CONTROL TOTAL)
       ========================================== */
    const APP_ACTIVA = true; // CAMBIA A "false" PARA BLOQUEAR TODO DESDE GITHUB
    /* ========================================== */

    const menu = {
        arroz: { nombre: "Arroz Especial", precio: 28000, cant: 0 }
    };

    window.onload = function() {
        // 1. Verificar bloqueo
        if (!APP_ACTIVA) {
            document.getElementById('pantalla-bloqueo').style.display = 'flex';
            document.getElementById('app-body').classList.add('oculto');
            return;
        }

        // 2. Verificar si hay usuario en memoria
        if (!localStorage.getItem('user_paila_china')) {
            document.getElementById('seccion-registro').classList.remove('oculto');
            document.getElementById('seccion-menu').classList.add('oculto');
        }
        
        // 3. Inicializar consecutivo
        if (!localStorage.getItem('cons_paila')) localStorage.setItem('cons_paila', 1);
    };

    function registrar() {
        const u = {
            n: document.getElementById('reg-nombre').value,
            d: document.getElementById('reg-direccion').value,
            t: document.getElementById('reg-tel').value,
            e: document.getElementById('reg-correo').value
        };
        if (u.n && u.d && u.t) {
            localStorage.setItem('user_paila_china', JSON.stringify(u));
            location.reload();
        } else {
            alert("Por favor, llena los campos obligatorios.");
        }
    }

    function cambiarCant(item, val) {
        menu[item].cant = Math.max(0, menu[item].cant + val);
        document.getElementById(`cant-${item}`).innerText = menu[item].cant;
        let total = 0;
        for (let k in menu) total += menu[k].cant * menu[k].precio;
        document.getElementById('total-display').innerText = "$" + total.toLocaleString('es-CO');
    }

    function enviarWhatsApp() {
        let totalPedido = 0;
        for (let k in menu) totalPedido += menu[k].cant * menu[k].precio;

        if (totalPedido === 0) return alert("Selecciona al menos un plato.");

        const user = JSON.parse(localStorage.getItem('user_paila_china'));
        const consecutivo = localStorage.getItem('cons_paila');
        const obs = document.getElementById('pedido-obs').value;
        const fecha = new Date().toLocaleString("es-CO", {timeZone: "America/Bogota"});

        // CONSTRUCCI√ìN DEL MENSAJE
        let msg = `üèÆ *NUEVO PEDIDO: LA PAILA CHINA* üèÆ\n`;
        msg += `----------------------------------\n`;
        msg += `*Pedido No:* #${consecutivo}\n`;
        msg += `*Fecha:* ${fecha}\n\n`;
        msg += `*CLIENTE:* ${user.n}\n`;
        msg += `*DIR:* ${user.d}\n`;
        msg += `*TEL:* ${user.t}\n\n`;
        msg += `*DETALLE:* \n`;
        for (let k in menu) {
            if (menu[k].cant > 0) {
                msg += `‚Ä¢ ${menu[k].cant}x ${menu[k].nombre} ($${(menu[k].cant * menu[k].precio).toLocaleString('es-CO')})\n`;
            }
        }
        msg += `\nüìù *OBS:* ${obs || 'Ninguna'}\n`;
        msg += `----------------------------------\n`;
        msg += `üí∞ *TOTAL A PAGAR: $${totalPedido.toLocaleString('es-CO')}*`;

        // Guardar nuevo consecutivo
        localStorage.setItem('cons_paila', parseInt(consecutivo) + 1);

        // Abrir WhatsApp
        window.open(`https://wa.me/573117700431?text=${encodeURIComponent(msg)}`, '_blank');
    }
</script>

</body>
</html>
