<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LA PAILA CHINA - Pedidos</title>
    <style>
        :root {
            --rojo: #CC0000;
            --dorado: #FFD700;
            --negro: #1a1a1a;
            --gris-card: #222222;
            --blanco: #ffffff;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--negro);
            color: var(--blanco);
            margin: 0;
            padding-bottom: 100px;
        }

        /* PANTALLA DE BLOQUEO (CONTROL TOTAL DESDE GITHUB) */
        #bloqueo-pago {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 99999; display: none;
            flex-direction: column; justify-content: center; align-items: center;
            text-align: center; padding: 30px;
        }

        header {
            background-color: var(--rojo);
            text-align: center;
            padding: 20px;
            border-bottom: 4px solid var(--dorado);
        }

        .logo-img {
            max-width: 120px;
            height: auto;
            margin-bottom: 10px;
            border-radius: 10px;
        }

        .titulo-empresa { font-size: 26px; font-weight: bold; color: var(--dorado); margin: 0; text-transform: uppercase; }
        .firma-vibras { font-size: 11px; color: white; margin-top: 2px; letter-spacing: 1px; font-style: italic; font-weight: 300; }
        .subtitulo { font-size: 13px; margin-top: 8px; opacity: 0.9; line-height: 1.4; }

        .container { padding: 15px; }

        /* Estilo de Tarjetas */
        .plato-card {
            background: var(--gris-card);
            border-radius: 15px;
            padding: 15px;
            border-left: 6px solid var(--rojo);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .plato-info .nombre { color: var(--dorado); font-weight: bold; font-size: 1.2em; }
        .plato-info .desc { font-size: 0.85em; color: #bbb; margin: 5px 0; }
        .plato-info .precio { color: #2ecc71; font-weight: bold; font-size: 1.2em; }

        .controles { display: flex; align-items: center; gap: 15px; }
        .btn-accion {
            background: var(--rojo); color: white; border: none;
            width: 42px; height: 42px; border-radius: 50%;
            font-size: 24px; font-weight: bold; cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        input, textarea {
            width: 100%; background: #111; color: white;
            border: 1px solid #333; border-radius: 10px; padding: 14px;
            margin-top: 10px; box-sizing: border-box; font-size: 16px;
        }

        .footer {
            position: fixed; bottom: 0; width: 100%; background: #000;
            padding: 15px 20px; border-top: 2px solid #333;
            display: flex; justify-content: space-between; align-items: center; box-sizing: border-box;
            z-index: 100;
        }

        .btn-whatsapp {
            background: #25D366; color: white; border: none;
            padding: 14px 25px; border-radius: 30px; font-weight: bold;
            cursor: pointer; font-size: 16px;
            box-shadow: 0 4px 10px rgba(37, 211, 102, 0.3);
        }

        .oculto { display: none !important; }
    </style>
</head>
<body>

<div id="bloqueo-pago">
    <h1 style="font-size: 70px; margin: 0;">üèÆ</h1>
    <h2 style="color: var(--dorado); letter-spacing: 2px;">SERVICIO SUSPENDIDO</h2>
    <p>La licencia de esta aplicaci√≥n ha expirado o se encuentra en mantenimiento t√©cnico.</p>
    <p>Para reactivar el sistema de pedidos, por favor contacte al desarrollador.</p>
</div>

<div id="app-content">
    <header>
        <img src="paila-china.png" alt="Logo La Paila China" class="logo-img" onerror="this.style.display='none'">
        
        <div class="titulo-empresa">LA PAILA CHINA</div>
        <div class="firma-vibras">Hecha por Vibras Positivas</div>
        
        <div class="subtitulo">
            üìç Sector Principal, Caucasia<br>
            üìû Domicilios: 311 770 0431
        </div>
    </header>

    <div class="container">
        <div id="seccion-registro" class="oculto">
            <h3 style="color: var(--dorado); text-align: center; margin-top: 0;">Datos del Domicilio</h3>
            <p style="text-align: center; font-size: 13px; color: #ccc;">Ingresa tus datos para procesar tu pedido por WhatsApp.</p>
            <input type="text" id="user-nom" placeholder="Nombre Completo">
            <input type="text" id="user-dir" placeholder="Direcci√≥n Exacta">
            <input type="tel" id="user-tel" placeholder="N√∫mero Celular">
            <button onclick="guardarDatos()" class="btn-whatsapp" style="width: 100%; background: var(--rojo); margin-top: 15px;">GUARDAR Y VER MEN√ö</button>
        </div>

        <div id="seccion-menu">
            <div class="plato-card">
                <div class="plato-info">
                    <div class="nombre">Arroz Especial</div>
                    <div class="desc">Lomo, pollo, ra√≠ces chinas y salsa soja.</div>
                    <div class="precio">$28.000</div>
                </div>
                <div class="controles">
                    <button class="btn-accion" onclick="modificarCantidad(-1)">-</button>
                    <span id="cantidad-txt" style="font-size: 22px; font-weight: bold; color: var(--dorado);">0</span>
                    <button class="btn-accion" onclick="modificarCantidad(1)">+</button>
                </div>
            </div>

            <h3 style="margin-top: 30px; font-size: 1.1em; border-bottom: 1px solid #333; padding-bottom: 8px;">Notas del Pedido</h3>
            <textarea id="pedido-obs" placeholder="Ej: Traer cambio de 50 mil, casa azul de rejas, sin cebolla..."></textarea>
        </div>
    </div>

    <div class="footer">
        <div>
            <div style="font-size: 0.8em; color: #aaa;">Total a pagar:</div>
            <div id="total-val" style="color: var(--dorado); font-weight: bold; font-size: 1.4em;">$0</div>
        </div>
        <button class="btn-whatsapp" onclick="enviarPedido()">PEDIR POR WHATSAPP</button>
    </div>
</div>

<script>
    /* ==========================================
       CONTROL DE SUSCRIPCI√ìN (LLAVE MAESTRA)
       ========================================== */
    const APP_ACTIVA = true; // CAMBIA A "false" PARA BLOQUEAR DESDE GITHUB
    /* ========================================== */

    let cantidad = 0;
    const precioUnidad = 28000;

    window.onload = function() {
        // Verificar si la aplicaci√≥n est√° habilitada
        if (!APP_ACTIVA) {
            document.getElementById('bloqueo-pago').style.display = 'flex';
            document.getElementById('app-content').classList.add('oculto');
            return;
        }

        // Cargar datos de usuario si existen
        const userSaved = localStorage.getItem('paila_user_info');
        if (!userSaved) {
            document.getElementById('seccion-registro').classList.remove('oculto');
            document.getElementById('seccion-menu').classList.add('oculto');
        }

        // Inicializar contador de pedidos
        if (!localStorage.getItem('paila_consec')) {
            localStorage.setItem('paila_consec', 1);
        }
    };

    function guardarDatos() {
        const n = document.getElementById('user-nom').value;
        const d = document.getElementById('user-dir').value;
        const t = document.getElementById('user-tel').value;
        
        if (n && d && t) {
            localStorage.setItem('paila_user_info', JSON.stringify({nombre: n, direccion: d, telefono: t}));
            location.reload();
        } else {
            alert("Por favor completa todos los campos para poder continuar.");
        }
    }

    function modificarCantidad(valor) {
        cantidad = Math.max(0, cantidad + valor);
        document.getElementById('cantidad-txt').innerText = cantidad;
        document.getElementById('total-val').innerText = "$" + (cantidad * precioUnidad).toLocaleString('es-CO');
    }

    function enviarPedido() {
        if (cantidad === 0) return alert("Por favor, agrega al menos un plato a tu pedido.");
        
        const user = JSON.parse(localStorage.getItem('paila_user_info'));
        const nPedido = localStorage.getItem('paila_consec');
        const obs = document.getElementById('pedido-obs').value || 'Sin observaciones adicionales';
        const ahora = new Date().toLocaleString("es-CO", {timeZone: "America/Bogota"});

        let texto = `üèÆ *NUEVO PEDIDO: LA PAILA CHINA* üèÆ\n`;
        texto += `------------------------------------------\n`;
        texto += `*Pedido No:* #${nPedido}\n`;
        texto += `*Fecha:* ${ahora}\n\n`;
        texto += `*CLIENTE:* ${user.nombre}\n`;
        texto += `*DIRECCI√ìN:* ${user.direccion}\n`;
        texto += `*TEL√âFONO:* ${user.telefono}\n\n`;
        texto += `*DETALLE DEL PEDIDO:* \n`;
        texto += `‚Ä¢ ${cantidad}x Arroz Especial ($${(cantidad * precioUnidad).toLocaleString('es-CO')})\n\n`;
        texto += `üìù *OBS:* ${obs}\n`;
        texto += `------------------------------------------\n`;
        texto += `*TOTAL A PAGAR: $${(cantidad * precioUnidad).toLocaleString('es-CO')}*`;

        // Incrementar el n√∫mero de pedido para la pr√≥xima
        localStorage.setItem('paila_consec', parseInt(nPedido) + 1);

        // N√∫mero de WhatsApp del restaurante
        const whatsappRestaurante = "573117700431";
        
        // Abrir enlace de WhatsApp
        const url = `https://wa.me/${whatsappRestaurante}?text=${encodeURIComponent(texto)}`;
        window.open(url, '_blank');
    }
</script>

</body>
</html>
