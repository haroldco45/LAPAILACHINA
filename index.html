<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LA PAILA CHINA - Pedidos</title>
    <style>
        :root {
            --rojo: #CC0000;
            --dorado: #FFD700;
            --negro: #1a1a1a;
            --gris-card: #222222;
            --verde-precio: #2ecc71;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--negro);
            color: white;
            margin: 0;
            padding-bottom: 120px;
        }

        #bloqueo-pago {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 99999; display: none;
            flex-direction: column; justify-content: center; align-items: center;
            text-align: center; padding: 30px;
        }

        header {
            background-color: var(--rojo);
            text-align: center;
            padding: 20px;
            border-bottom: 4px solid var(--dorado);
        }

        .logo-img { max-width: 130px; margin-bottom: 8px; border-radius: 8px; }
        .titulo-app { font-size: 26px; font-weight: bold; color: var(--dorado); margin: 0; text-transform: uppercase; }
        .firma { font-size: 10px; color: white; margin-top: 2px; font-style: italic; letter-spacing: 1px; }
        .info-oficial { font-size: 13px; margin-top: 10px; line-height: 1.5; color: white; }

        .container { padding: 15px; }
        .categoria-titulo { 
            color: var(--dorado); 
            border-bottom: 1px solid var(--rojo); 
            padding: 10px 0; 
            margin-top: 25px;
            text-transform: uppercase;
            font-weight: bold;
        }

        .plato-card {
            background: var(--gris-card);
            border-radius: 12px;
            padding: 15px;
            margin-top: 12px;
            border-left: 6px solid var(--rojo);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .plato-info .nombre { color: var(--dorado); font-weight: bold; font-size: 1.1em; }
        .plato-info .precio { color: var(--verde-precio); font-weight: bold; font-size: 1.15em; margin-top: 5px; }

        .controles { display: flex; align-items: center; gap: 15px; }
        .btn-accion {
            background: var(--rojo); color: white; border: none;
            width: 38px; height: 38px; border-radius: 50%;
            font-size: 22px; font-weight: bold; cursor: pointer;
        }

        select, input, textarea {
            width: 100%; background: #111; color: white;
            border: 1px solid #333; border-radius: 10px; padding: 12px;
            margin-top: 10px; box-sizing: border-box; font-size: 16px;
        }

        label { display: block; margin-top: 20px; color: var(--dorado); font-weight: bold; font-size: 0.9em; }

        .footer {
            position: fixed; bottom: 0; width: 100%; background: #000;
            padding: 15px 20px; border-top: 2px solid #333;
            display: flex; justify-content: space-between; align-items: center; box-sizing: border-box;
            z-index: 1000;
        }

        .btn-pedir {
            background: #25D366; color: white; border: none;
            padding: 14px 25px; border-radius: 30px; font-weight: bold; cursor: pointer;
            box-shadow: 0 4px 10px rgba(37, 211, 102, 0.2);
        }

        .oculto { display: none !important; }
    </style>
</head>
<body>

<div id="bloqueo-pago">
    <h1 style="font-size: 60px;">üèÆ</h1>
    <h2 style="color: var(--dorado);">SERVICIO SUSPENDIDO</h2>
    <p>La licencia de uso ha expirado.</p>
    <p>Contacte al administrador para renovar el servicio.</p>
</div>

<div id="app-content">
    <header>
        <img src="paila-china.png" class="logo-img" onerror="this.style.display='none'">
        <div class="titulo-app">LA PAILA CHINA</div>
        <div class="firma">Hecha por Vibras Positivas</div>
        <div class="info-oficial">
            üìç Calle 11a N21-68 barrio el triangulo<br>
            üìû Contacto: 312 296 7241
        </div>
    </header>

    <div class="container">
        <div id="registro" class="oculto">
            <h3 style="text-align: center; color: var(--dorado);">Datos para el Domicilio</h3>
            <input type="text" id="r-nom" placeholder="Nombre Completo">
            <input type="text" id="r-dir" placeholder="Direcci√≥n de Entrega">
            <input type="tel" id="r-tel" placeholder="N√∫mero Celular">
            <button onclick="guardarU()" class="btn-pedir" style="width: 100%; background: var(--rojo); margin-top: 15px;">ENTRAR AL MEN√ö</button>
        </div>

        <div id="menu-cont">
            <div class="categoria-titulo">Seleccione sus Sopas / Almuerzos</div>
            <div id="items-sopas"></div>

            <div class="categoria-titulo">Arroz Chino</div>
            <div id="items-arroz"></div>

            <div class="categoria-titulo">Combos Especiales</div>
            <div id="items-combos"></div>
        </div>

        <label for="pago-metodo">Forma de Pago:</label>
        <select id="pago-metodo">
            <option value="Efectivo">Efectivo</option>
            <option value="Transferencia">Transferencia (Nequi/Bancolombia)</option>
        </select>

        <textarea id="obs" placeholder="Observaciones: (Ej. Sin cebolla, casa de rejas blancas, cambio de 50 mil...)"></textarea>
    </div>

    <div class="footer">
        <div>
            <div style="font-size: 11px; color: #aaa;">Total Pedido:</div>
            <div id="total-val" style="color: var(--dorado); font-weight: bold; font-size: 1.3em;">$0</div>
        </div>
        <button class="btn-pedir" onclick="enviarPedido()">PEDIR POR WHATSAPP</button>
    </div>
</div>

<script>
    const APP_ACTIVA = true; 

    const menuData = {
        // SOPAS Y FRIJOLES INTEGRADOS
        "mote": { n: "Sopa de Mote", p: 21000, cat: "sopas" },
        "mondongo": { n: "Sopa de Mondongo", p: 21000, cat: "sopas" },
        "gallina": { n: "Sopa de Gallina", p: 21000, cat: "sopas" },
        "frijoles": { n: "Frijoles (con sopa del d√≠a)", p: 20000, cat: "sopas" },
        
        // ARROZ CHINO
        "arroz1": { n: "Arroz Chino Personal", p: 17000, cat: "arroz" },
        "arroz2": { n: "Arroz Chino 2 Personas", p: 23000, cat: "arroz" },
        "arroz4": { n: "Arroz Chino 4 Personas", p: 32000, cat: "arroz" },
        "arroz6": { n: "Arroz Chino 6 Personas", p: 40000, cat: "arroz" },
        "arroz9": { n: "Arroz Chino 9 Personas", p: 50000, cat: "arroz" },
        
        // COMBOS
        "mega": { n: "1 Pollo + Arroz Mega", p: 73000, cat: "combos" },
        "grande": { n: "1 Pollo + Arroz Grande", p: 63000, cat: "combos" },
        "mediano": { n: "1/2 Pollo + Arroz Mediano", p: 45000, cat: "combos" },
        "cuarto": { n: "1/4 Pollo + Arroz", p: 31000, cat: "combos" },
        "presa_p": { n: "1 Presa + Arroz Personal", p: 22000, cat: "combos" },
        "presa_c": { n: "1 Presa + Arroz + Chop Suey", p: 25000, cat: "combos" }
    };

    let carrito = {};

    window.onload = () => {
        if (!APP_ACTIVA) {
            document.getElementById('bloqueo-pago').style.display = 'flex';
            document.getElementById('app-content').classList.add('oculto');
            return;
        }
        if (!localStorage.getItem('p_user_v4')) {
            document.getElementById('registro').classList.remove('oculto');
            document.getElementById('menu-cont').classList.add('oculto');
        }
        if (!localStorage.getItem('p_cons')) localStorage.setItem('p_cons', 1);
        renderMenu();
    };

    function renderMenu() {
        for (let id in menuData) {
            const item = menuData[id];
            const html = `
                <div class="plato-card">
                    <div class="plato-info">
                        <div class="nombre">${item.n}</div>
                        <div class="precio">$${item.p.toLocaleString('es-CO')}</div>
                    </div>
                    <div class="controles">
                        <button class="btn-accion" onclick="sumar('${id}', -1)">-</button>
                        <span id="cant-${id}" style="font-weight:bold; width:20px; text-align:center;">0</span>
                        <button class="btn-accion" onclick="sumar('${id}', 1)">+</button>
                    </div>
                </div>`;
            document.getElementById('items-' + item.cat).innerHTML += html;
        }
    }

    function guardarU() {
        const n = document.getElementById('r-nom').value, d = document.getElementById('r-dir').value, t = document.getElementById('r-tel').value;
        if(n && d && t) {
            localStorage.setItem('p_user_v4', JSON.stringify({n, d, t}));
            location.reload();
        } else alert("Por favor completa los datos de env√≠o.");
    }

    function sumar(id, v) {
        carrito[id] = Math.max(0, (carrito[id] || 0) + v);
        document.getElementById('cant-' + id).innerText = carrito[id];
        let total = 0;
        for (let k in carrito) total += carrito[k] * menuData[k].p;
        document.getElementById('total-val').innerText = "$" + total.toLocaleString('es-CO');
    }

    function enviarPedido() {
        let total = 0, detalle = "", user = JSON.parse(localStorage.getItem('p_user_v4')), nPed = localStorage.getItem('p_cons');
        const pago = document.getElementById('pago-metodo').value;

        for (let k in carrito) {
            if (carrito[k] > 0) {
                total += carrito[k] * menuData[k].p;
                detalle += `‚Ä¢ ${carrito[k]}x ${menuData[k].n}\n`;
            }
        }
        if (total === 0) return alert("Selecciona productos para tu pedido.");
        
        const hora = new Date().toLocaleString("es-CO", {timeZone: "America/Bogota"});
        let msg = `üèÆ *PEDIDO: LA PAILA CHINA* üèÆ\n`;
        msg += `*No:* #${nPed} | *Fecha:* ${hora}\n\n`;
        msg += `*CLIENTE:* ${user.n}\n*DIR:* ${user.d}\n*TEL:* ${user.t}\n\n`;
        msg += `*PRODUCTOS:*\n${detalle}\n`;
        msg += `*FORMA DE PAGO:* ${pago}\n`;
        msg += `*TOTAL A PAGAR: $${total.toLocaleString('es-CO')}*\n\n`;
        msg += `*OBS:* ${document.getElementById('obs').value || 'Ninguna'}`;

        localStorage.setItem('p_cons', parseInt(nPed) + 1);
        window.open(`https://wa.me/573122967241?text=${encodeURIComponent(msg)}`, '_blank');
    }
</script>
</body>
</html>
