<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LA PAILA CHINA - Pedidos</title>
    <style>
        :root {
            --rojo-china: #CC0000;
            --dorado: #FFD700;
            --negro: #1a1a1a;
            --blanco: #ffffff;
            --gris-oscuro: #2a2a2a;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--negro);
            color: var(--blanco);
            margin: 0;
            padding-bottom: 100px;
        }

        /* Encabezado y Logo */
        header {
            background-color: var(--rojo-china);
            text-align: center;
            padding: 20px;
            border-bottom: 4px solid var(--dorado);
        }

        .logo-container img {
            max-width: 150px;
            height: auto;
            margin-bottom: 10px;
        }

        .titulo-restaurante {
            font-size: 26px;
            font-weight: bold;
            color: var(--dorado);
            text-transform: uppercase;
            margin: 0;
        }

        .info-contacto {
            font-size: 0.85em;
            margin-top: 5px;
            color: var(--blanco);
            line-height: 1.4;
        }

        /* Control de Suscripci√≥n */
        .reloj-sub {
            background: var(--dorado);
            color: var(--negro);
            font-size: 11px;
            padding: 4px;
            text-align: center;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .container { padding: 20px; }

        /* Formulario de Registro (Primera Vez) */
        #seccion-registro {
            background: var(--gris-oscuro);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid var(--dorado);
        }

        input, textarea {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #444;
            background: #111;
            color: white;
            box-sizing: border-box;
            font-size: 16px;
        }

        /* Cards de Men√∫ */
        .plato-card {
            background: var(--gris-oscuro);
            border-radius: 12px;
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 15px;
            border-left: 6px solid var(--rojo-china);
        }

        .plato-img {
            width: 90px;
            height: 90px;
            background: #444;
            border-radius: 10px;
            margin-right: 15px;
            object-fit: cover;
        }

        .plato-detalles { flex-grow: 1; }

        .plato-nombre {
            font-weight: bold;
            color: var(--dorado);
            font-size: 1.1em;
            margin-bottom: 4px;
        }

        .plato-desc {
            font-size: 0.85em;
            color: #ccc;
            margin-bottom: 8px;
        }

        .plato-precio {
            color: #4CAF50;
            font-weight: bold;
            font-size: 1.1em;
        }

        /* Controles de Cantidad */
        .controles {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            min-width: 40px;
        }

        .btn-accion {
            background: var(--rojo-china);
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-weight: bold;
            font-size: 20px;
            cursor: pointer;
        }

        .cantidad-display {
            font-weight: bold;
            font-size: 18px;
            color: var(--dorado);
        }

        /* Footer y Total */
        .footer-fixed {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: #000;
            border-top: 3px solid var(--rojo-china);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-sizing: border-box;
        }

        .total-texto {
            font-size: 1.2em;
            font-weight: bold;
        }

        .total-monto { color: var(--dorado); }

        .btn-finalizar {
            background: #25D366;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(37, 211, 102, 0.3);
        }

        .oculto { display: none; }
    </style>
</head>
<body>

<div class="reloj-sub" id="status-suscripcion">Suscripci√≥n: Estado Activo ‚úÖ</div>

<header>
    <div class="logo-container">
        <img src="logo.png" alt="LA PAILA CHINA" onerror="this.style.display='none'">
        <div class="titulo-restaurante">La Paila China</div>
    </div>
    <div class="info-contacto">
        üìç Direcci√≥n: Sector Principal, Caucasia<br>
        üìû Domicilios: 311 770 0431
    </div>
</header>

<div class="container">
    <div id="seccion-registro" class="oculto">
        <h2 style="color: var(--dorado); text-align: center;">¬°Bienvenido!</h2>
        <p style="text-align: center; font-size: 0.9em;">Ingresa tus datos de entrega para continuar. Se guardar√°n para tus pr√≥ximos pedidos.</p>
        <input type="text" id="user-nombre" placeholder="Nombre Apellido">
        <input type="text" id="user-direccion" placeholder="Direcci√≥n de residencia / Local">
        <input type="tel" id="user-tel" placeholder="N√∫mero de Celular">
        <input type="email" id="user-email" placeholder="Correo electr√≥nico">
        <button onclick="registrarUsuario()" class="btn-finalizar" style="width: 100%; margin-top: 10px;">GUARDAR Y VER MEN√ö</button>
    </div>

    <div id="seccion-menu">
        <h3 style="border-bottom: 1px solid var(--rojo-china); padding-bottom: 10px;">Men√∫ Principal</h3>
        
        <div class="plato-card">
            <div class="plato-detalles">
                <div class="plato-nombre">Arroz Especial Grande</div>
                <div class="plato-desc">Arroz con lomo, pollo, ra√≠ces chinas y salsa de la casa.</div>
                <div class="plato-precio">$28.000</div>
            </div>
            <div class="controles">
                <button class="btn-accion" onclick="modificar('arroz', 1)">+</button>
                <span class="cantidad-display" id="cnt-arroz">0</span>
                <button class="btn-accion" onclick="modificar('arroz', -1)">-</button>
            </div>
        </div>

        <div class="plato-card">
            <div class="plato-detalles">
                <div class="plato-nombre">Combo Lumpias (x4)</div>
                <div class="plato-desc">Empanadillas chinas rellenas de vegetal y cerdo.</div>
                <div class="plato-precio">$14.000</div>
            </div>
            <div class="controles">
                <button class="btn-accion" onclick="modificar('lumpias', 1)">+</button>
                <span class="cantidad-display" id="cnt-lumpias">0</span>
                <button class="btn-accion" onclick="modificar('lumpias', -1)">-</button>
            </div>
        </div>

        <h3 style="margin-top: 30px;">Instrucciones Adicionales</h3>
        <textarea id="pedido-obs" rows="3" placeholder="Ej: La casa es azul, traer cambio de 50 mil, sin cebolla..."></textarea>
    </div>
</div>

<div class="footer-fixed">
    <div class="total-texto">Total: <span class="total-monto" id="total-vta">$0</span></div>
    <button class="btn-finalizar" onclick="procesarPedido()">Pedir por WhatsApp</button>
</div>

<script>
    // Configuraci√≥n Inicial
    const menu = {
        arroz: { nombre: "Arroz Especial Grande", precio: 28000, cant: 0 },
        lumpias: { nombre: "Combo Lumpias (x4)", precio: 14000, cant: 0 }
    };

    window.onload = function() {
        const usuarioExistente = localStorage.getItem('paila_china_user');
        if (!usuarioExistente) {
            document.getElementById('seccion-registro').classList.remove('oculto');
            document.getElementById('seccion-menu').classList.add('oculto');
        }
        
        if(!localStorage.getItem('paila_consecutivo')) {
            localStorage.setItem('paila_consecutivo', 1);
        }
    };

    function registrarUsuario() {
        const datos = {
            nombre: document.getElementById('user-nombre').value,
            dir: document.getElementById('user-direccion').value,
            tel: document.getElementById('user-tel').value,
            mail: document.getElementById('user-email').value
        };

        if(datos.nombre && datos.dir && datos.tel) {
            localStorage.setItem('paila_china_user', JSON.stringify(datos));
            alert("¬°Datos guardados con √©xito!");
            location.reload();
        } else {
            alert("Por favor completa los campos obligatorios.");
        }
    }

    function modificar(item, valor) {
        menu[item].cant = Math.max(0, menu[item].cant + valor);
        document.getElementById(`cnt-${item}`).innerText = menu[item].cant;
        actualizarTotal();
    }

    function actualizarTotal() {
        let total = 0;
        for (let clave in menu) {
            total += menu[clave].cant * menu[clave].precio;
        }
        document.getElementById('total-vta').innerText = "$" + total.toLocaleString('es-CO');
        return total;
    }

    function procesarPedido() {
        const total = actualizarTotal();
        if (total === 0) {
            alert("Debes seleccionar al menos un plato.");
            return;
        }

        const confirmacion = confirm("¬øDeseas verificar y enviar tu pedido ahora?");
        if (!confirmacion) return;

        const user = JSON.parse(localStorage.getItem('paila_china_user'));
        const consecutivo = localStorage.getItem('paila_consecutivo');
        const obs = document.getElementById('pedido-obs').value;
        const horaColombia = new Date().toLocaleString("es-CO", {timeZone: "America/Bogota"});

        // CONSTRUCCI√ìN DEL MENSAJE
        let msg = "üèÆ *NUEVO PEDIDO: LA PAILA CHINA* üèÆ\n";
        msg += "------------------------------------------\n";
        msg += "*PEDIDO N¬∞:* " + consecutivo + "\n";
        msg += "*FECHA:* " + horaColombia + "\n\n";
        
        msg += "*CLIENTE:* " + user.nombre + "\n";
        msg += "*DIRECCI√ìN:* " + user.dir + "\n";
        msg += "*TEL:* " + user.tel + "\n\n";
        
        msg += "*PRODUCTOS:* \n";
        for (let clave in menu) {
            if (menu[clave].cant > 0) {
                let subtotal = menu[clave].cant * menu[clave].precio;
                msg += "‚Ä¢ " + menu[clave].cant + "x " + menu[clave].nombre + " ($" + subtotal.toLocaleString('es-CO') + ")\n";
            }
        }

        msg += "\nüìù *OBS:* " + (obs ? obs : "Sin observaciones") + "\n";
        msg += "------------------------------------------\n";
        msg += "üí∞ *TOTAL A PAGAR: $" + total.toLocaleString('es-CO') + "*\n";
        msg += "------------------------------------------";

        // Incrementar consecutivo para la pr√≥xima vez
        localStorage.setItem('paila_consecutivo', parseInt(consecutivo) + 1);

        // Env√≠o seguro a WhatsApp
        const url = "https://wa.me/573117700431?text=" + encodeURIComponent(msg);
        window.open(url, '_blank');
    }
</script>

</body>
</html>
